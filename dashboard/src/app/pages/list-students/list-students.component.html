<div class="m-4 flex flex-col items-center text-text-950">
  <h2 class="my-6 text-2xl font-bold">Student Conflict Manager</h2>

  <h3 class="mb-2 text-lg font-semibold">Conflicts (Multiple Pending Assignments)</h3>
  @for (student of conflicts(); track $index) {
    <div class="mb-4">
      <label>{{ student.firstName }} {{ student.lastName }} ({{ student.studentClass }})</label>
      @for (assignment of student.studentAssignments; track $index) {
        <div class="flex items-center">
          <label for="approve-{{ student.edufsUsername }}-{{ assignment.stopId }}" class="ml-2">{{ assignment.stopName }}</label>
          @if (assignment.status === 1) {
            <!--Already approved-->
            <button
              class="mx-2 rounded bg-primary-200 px-4 py-2 text-text-950 hover:bg-primary-300"
              (click)="changeAssignmentStatus(student, $index, Status.Pending)"
            >
              Approved (undo)
            </button>
          } @else {
            <button
              (click)="changeAssignmentStatus(student, $index, Status.Accepted)"
              class="mx-2 my-2 rounded border bg-primary-200 px-4 py-2 text-white shadow hover:bg-primary-300"
            >
              Approve
            </button>
          }
          @if (assignment.status === 2) {
            <!--Already rejected-->
            <button
              class="mx-2 rounded bg-primary-200 px-4 py-2 text-text-950 hover:bg-primary-300"
              (click)="changeAssignmentStatus(student, $index, Status.Pending)"
            >
              Rejected (undo)
            </button>
          } @else {
            <button
              (click)="changeAssignmentStatus(student, $index, Status.Declined)"
              class="mx-2 rounded border bg-primary-200 px-4 py-2 text-white shadow hover:bg-primary-300"
            >
              Reject
            </button>
          }
        </div>
      }
    </div>
  }

  <div class="flex items-center">
    <h3 class="text-lg font-semibold">Single Assignments</h3>
    <button (click)="autoApproveAll()" class="m-4 rounded bg-primary-200 px-4 py-2 text-text-950 hover:bg-primary-300">Auto Approve All</button>
  </div>

  @for (student of singleAssignments(); track $index) {
    <div class="mb-2 flex items-center">
      <input type="checkbox" id="approve-{{ student.edufsUsername }}" (change)="changeAssignmentStatus(student, 0, Status.Accepted)" />
      <label for="approve-{{ student.edufsUsername }}" class="ml-2">{{ student.firstName }} {{ student.lastName }}</label>
    </div>
  }

  <h3 class="mb-2 mt-6 text-lg font-semibold">No Assignments</h3>
  <ul>
    @for (student of noAssignments(); track $index) {
      <li>{{ student.firstName }} {{ student.lastName }} ({{ student.studentClass }})</li>
    }
  </ul>
</div>
